# Dockerfile.dev pour le client frontend (React + Vite)
# Utilise Node.js 18 Alpine pour un environnement léger et sécurisé
FROM node:18-alpine

# Définit le répertoire de travail dans le conteneur
WORKDIR /app

# Copie les fichiers package.json et package-lock.json à la racine
COPY package*.json ./

# Copie les fichiers package.json du client
COPY client/package*.json ./client/

# Copie les fichiers package.json du shared
COPY shared/package*.json ./shared/

# Installe les dépendances à la racine
RUN npm install

# Installe les dépendances du client
WORKDIR /app/client
RUN npm install

# Retourne à la racine
WORKDIR /app

# Copie tout le code source du client et shared
COPY client/ ./client/
COPY shared/ ./shared/

# Expose le port 5173 pour le serveur de développement Vite
# Vite utilise le port 5173 par défaut pour le hot reload
EXPOSE 5173

# Commande par défaut pour démarrer le serveur de développement Vite
# Le hot reload sera géré par les volumes dans docker-compose
CMD ["npm", "run", "dev", "--prefix", "client"]
